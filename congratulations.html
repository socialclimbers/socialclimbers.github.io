<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Thank you — Social Climbers</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<!-- Toast notification (global) -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 1100">
  <div id="cartToast" class="toast align-items-center text-bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="d-flex">
      <div class="toast-body" id="cartToastBody">
        Added to cart!
      </div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
  </div>
</div>

<body>
  <main class="container py-5 text-center">
    <img src="assets/social_climbers_logo.png" alt="" style="height:90px">
    <h1 class="mt-3">Thank you!</h1>
    <div id="thanks"></div>
    <p id="confirmationText" class="lead"></p>
    <a href="index.html" class="btn btn-primary">Back to Home</a>
  </main>

  <script>
const order = JSON.parse(localStorage.getItem('sc_lastOrder') || '{}');
const el = document.querySelector('#thanks');

if (order && order.items) {
  const servicesList = [
    'Indoor & Outdoor Coaching',
    'Guided Outdoor Trips',
    'Equipment Rental',
    'Route Setting & Gym Services',
    'Safety Workshops',
    'Corporate & Group Events'
  ];

  let containsService = false;

  // Format each item nicely
  const itemList = order.items.map(it => {
    if (typeof it === 'string') {
      return it; // old fallback
    } else {
      const subtotal = it.price * it.qty;
      const isService = servicesList.includes(it.name);
      if (isService) containsService = true;
      return `${it.name} × ${it.qty} ($${subtotal.toFixed(2)})` + 
             (isService ? " — service booking" : "");
    }
  });

  // Main order summary
  let html = `
    <p>Thanks <strong>${order.name}</strong> — your order for 
    <strong>${itemList.join(', ')}</strong> 
    (Total: $${order.total}) was received.</p>
    <p>Preferred date: ${order.date}.</p>
    <p>A confirmation was sent to <strong>${order.email}</strong>.</p>
  `;

  // Extra note if services are included
  if (containsService) {
    html += `
      <div class="alert alert-info mt-4" role="alert">
        Since your order includes a service, a member of our team will contact you by email 
        to confirm booking details.
      </div>
    `;
  }

  el.innerHTML = html;

} else {
  el.textContent = "No recent order found.";
}

  </script>
  <footer class="py-4 text-center">
  <div class="container">
    <p class="mb-1">&copy; <span class="year"></span> Social Climbers</p>
    <small class="text-muted">Website by <img src="assets/elevate_logo.png" alt="Elevate" class="logo-xs align-text-bottom"> Elevate Web Solutions</small>
  </div>
</footer>

</body>
</html>
